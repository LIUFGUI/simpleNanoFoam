/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  2412                                  |
|   \\  /    A nd           | Website:  www.openfoam.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : _8dbc61e11c-20241220 OPENFOAM=2412 version=v2412
Arch   : "LSB;label=32;scalar=64"
Exec   : snappyHexMesh -overwrite -parallel
Date   : Sep 19 2025
Time   : 15:49:28
Host   : ubuntu-linux-2404
PID    : 46331
I/O    : uncollated
Case   : /home/parallels/works/GeoChemFoam-5.1/runs/nanoPorousMedia1f/2DmicroPorousModel/multicomponentModel
nProcs : 8
Hosts  :
(
    (ubuntu-linux-2404 8)
)
Pstream initialized with:
    floatTransfer      : false
    maxCommsSize       : 0
    nProcsSimpleSum    : 0
    nonBlockingExchange: 0 (tuning: 0)
    exchange algorithm : 0
    commsType          : nonBlocking
    polling iterations : 0
trapFpe: Floating point exception trapping enabled (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster (fileModificationSkew 5, maxFileModificationPolls 20)
allowSystemOperations : Allowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0

Read mesh in = 0.5 s

Overall mesh bounding box  : (0 0 0) (1e-06 5e-07 1e-08)
Relative tolerance         : 1e-06
Absolute matching distance : 1.1180787e-12

Reading refinement surfaces.
Read refinement surfaces in = 0.06 s

Reading refinement shells.
Read refinement shells in = 0.01 s

Setting refinement level of surface to be consistent with shells.
For geometry Image_meshed.stl detected 0 uncached triangles out of 59426
Checked shell refinement in = 0.49 s

Reading features.
Read features in = 0 s


Determining initial surface intersections
-----------------------------------------

Edge intersection testing:
    Number of edges             : 4502250
    Number of edges to retest   : 0
    Number of intersected edges : 0
Edge intersection testing:
    Number of edges             : 4502250
    Number of edges to retest   : 4502250
    Number of intersected edges : 53151
Calculated surface intersections in = 2.29 s

Initial mesh : cells:1125000  faces:4502250  points:2254502  unbalance:0.004032
Cells per refinement level:
    0	1125000
Setting refinement level of surface to be consistent with curvature.
Checked curvature refinement in = 0 s


Adding patches for surface regions
----------------------------------

Patch Type                Region                        
----- ----                ------                        
fixedWalls:

4     wall                fixedWalls_inorganic          
5     wall                fixedWalls_organic            
6     wall                fixedWalls_clay               

Added patches in = 0.02 s

Edge intersection testing:
    Number of edges             : 4502250
    Number of edges to retest   : 0
    Number of intersected edges : 53151
Decomposition method scotch [8]

Refinement phase
----------------

Found point (8e-08 2e-08 0) in cell 10936 on processor 3

Surface refinement iteration 0
------------------------------

Marked for refinement due to surface intersection          : 0 cells.
Determined cells to refine in = 0.19 s
Selected for refinement : 0 cells (out of 1125000)
Stopping refining since too few cells selected.


Removing mesh beyond surface intersections
------------------------------------------

Setting cellZones according to locationsInMesh:
Location : (8e-08 2e-08 0)
    cellZone : none

For cellZone none found point (8e-08 2e-08 0) in global region 1 out of 195 regions.
--> FOAM Warning : 
    From void Foam::meshRefinement::nearestFace(const Foam::labelUList&, const Foam::bitSet&, Foam::autoPtr<Foam::mapDistribute>&, Foam::labelList&, Foam::label) const
    in file meshRefinement/meshRefinement.C at line 527
    Did not visit some faces, e.g. face 28 at (2.5866667e-07 3.3333333e-10 5e-09)
Keeping all cells containing inside points
Selected for keeping : 512663 cells.
Edge intersection testing:
    Number of edges             : 2078229
    Number of edges to retest   : 51580
    Number of intersected edges : 53151

Shell refinement iteration 0
----------------------------

Marked for refinement due to distance to explicit features : 0 cells.
Marked for refinement due to refinement shells             : 0 cells.
Determined cells to refine in = 0.64 s
Selected for internal refinement : 0 cells (out of 512663)
Stopping refining since too few cells selected.


Dangling coarse cells refinement iteration 0
--------------------------------------------

Determined cells to refine in = 0.01 s
Selected for refinement : 0 cells (out of 512663)
Stopping refining since too few cells selected.


Dangling coarse cells refinement iteration 0
--------------------------------------------

Determined cells to refine in = 0 s
Selected for refinement : 0 cells (out of 512663)
Stopping refining since too few cells selected.


Refinement transition refinement iteration 0
--------------------------------------------

Determined cells to refine in = 0.01 s
Selected for refinement : 0 cells (out of 512663)
Stopping refining since too few cells selected.


Splitting mesh at surface intersections
---------------------------------------

Introducing baffles for 53151 faces that are intersected by the surface.

Setting cellZones according to locationsInMesh:
Location : (8e-08 2e-08 0)
    cellZone : none

For cellZone none found point (8e-08 2e-08 0) in global region 1 out of 240 regions.
Edge intersection testing:
    Number of edges             : 2129381
    Number of edges to retest   : 399690
    Number of intersected edges : 104303
Created baffles in = 0.48 s


After introducing baffles : cells:512663  faces:2129381  points:1080200  unbalance:0.13145283
Cells per refinement level:
    0	512663

Introducing baffles to block off problem cells
----------------------------------------------

markFacesOnProblemCells : marked 52319 additional internal faces to be converted into baffles.
Analyzed problem cells in = 0.13 s


Introducing baffles to delete problem cells.

Edge intersection testing:
    Number of edges             : 2181579
    Number of edges to retest   : 313607
    Number of intersected edges : 104303
Created baffles in = 0.34 s


After introducing baffles : cells:512663  faces:2181579  points:1080592  unbalance:0.13145283
Cells per refinement level:
    0	512663
Setting cellZones according to locationsInMesh:
Location : (8e-08 2e-08 0)
    cellZone : none

For cellZone none found point (8e-08 2e-08 0) in global region 9 out of 52263 regions.
Edge intersection testing:
    Number of edges             : 2181579
    Number of edges to retest   : 422357
    Number of intersected edges : 104303

Remove unreachable sections of mesh
-----------------------------------

Keeping all cells containing points 1((8e-08 2e-08 0))
Selected for keeping : 460284 cells.
Edge intersection testing:
    Number of edges             : 1867456
    Number of edges to retest   : 0
    Number of intersected edges : 51111
Split mesh in = 0.72 s


After subsetting : cells:460284  faces:1867456  points:972886  unbalance:0.15115016
Cells per refinement level:
    0	460284

Introducing zones for interfaces
--------------------------------

Setting cellZones according to locationsInMesh:
Location : (8e-08 2e-08 0)
    cellZone : none

For cellZone none found point (8e-08 2e-08 0) in global region 0 out of 1 regions.
Setting faceZones according to neighbouring cellZones:

Edge intersection testing:
    Number of edges             : 1867456
    Number of edges to retest   : 0
    Number of intersected edges : 51111

Handling cells with snap problems
---------------------------------

Introducing baffles for 51111 faces that are intersected by the surface.

Setting cellZones according to locationsInMesh:
Location : (8e-08 2e-08 0)
    cellZone : none

For cellZone none found point (8e-08 2e-08 0) in global region 0 out of 1 regions.
Edge intersection testing:
    Number of edges             : 1867456
    Number of edges to retest   : 196869
    Number of intersected edges : 51111
Created baffles in = 0.55 s


After introducing baffles : cells:460284  faces:1867456  points:972886  unbalance:0.15115016
Cells per refinement level:
    0	460284

Introducing baffles to block off problem cells
----------------------------------------------

markFacesOnProblemCells : marked 0 additional internal faces to be converted into baffles.
Analyzed problem cells in = 0.1 s


Introducing baffles to delete problem cells.

Created baffles in = 0.02 s


After introducing baffles : cells:460284  faces:1867456  points:972886  unbalance:0.15115016
Cells per refinement level:
    0	460284
Setting cellZones according to locationsInMesh:
Location : (8e-08 2e-08 0)
    cellZone : none

For cellZone none found point (8e-08 2e-08 0) in global region 0 out of 1 regions.
Edge intersection testing:
    Number of edges             : 1867456
    Number of edges to retest   : 196869
    Number of intersected edges : 51111

Remove unreachable sections of mesh
-----------------------------------

Split mesh in = 0.37 s


After subsetting : cells:460284  faces:1867456  points:972886  unbalance:0.15115016
Cells per refinement level:
    0	460284

Merge free-standing baffles
---------------------------

freeStandingBaffles : detected 12 free-standing baffles out of 12

freeStandingBaffles : detected 12 planar (within 30 degrees) free-standing baffles out of 12

Detected free-standing baffles : 12
Edge intersection testing:
    Number of edges             : 1867444
    Number of edges to retest   : 12
    Number of intersected edges : 51099

Introducing baffles to block off problem cells
----------------------------------------------

markFacesOnProblemCells : marked 0 additional internal faces to be converted into baffles.
Analyzed problem cells in = 0.34 s


Introducing baffles to delete problem cells.

Created baffles in = 0.02 s


After introducing baffles : cells:460284  faces:1867444  points:972886  unbalance:0.15115016
Cells per refinement level:
    0	460284

Remove unreachable sections of mesh
-----------------------------------

Merged free-standing baffles in = 0.04 s


dupNonManifoldPoints : Found : 0 non-manifold points (out of 976334)
Detected unsplittable baffles : 0

Merge refined boundary faces
----------------------------

Merging 0 sets of faces.

No faces merged ...

Merging all points on surface that
- are used by only two boundary faces and
- make an angle with a cosine of more than 0.70710678.

No straight edges simplified and no points removed ...

Doing final balancing
---------------------

Found 0 zoned faces to keep together.
Found 0 separated coupled faces to keep together.
Refined mesh : cells:460284  faces:1867444  points:972886  unbalance:0.0063352191
Cells per refinement level:
    0	460284
Writing mesh to time constant
Wrote mesh in = 0.15 s.
Mesh refined in = 4.88 s.

Morphing phase
--------------

Duplicating 0 points on faceZones of type boundary
Constructing mesh displacer ...
Using mesh parameters 
{
    maxNonOrtho     30;
    maxBoundarySkewness 2;
    maxInternalSkewness 2;
    maxConcave      30;
    minVol          -1;
    minTetQuality   0;
    minArea         -1;
    minTwist        0.01;
    minDeterminant  0.01;
    minFaceWeight   0.1;
    minVolRatio     0.1;
    minTriangleTwist -1;
    nSmoothScale    4;
    errorReduction  0.75;
}


Checking initial mesh ...
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 0
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0
Detected 0 illegal faces (concave, zero area or negative cell pyramid volume)
Checked initial mesh in = 1.13 s


Smoothing patch points ...
Smoothing iteration 0
Found 0 non-manifold point(s).

Scaling iteration 0
Moving mesh using displacement scaling : min:1  max:1
Correcting 2-D mesh motion--> FOAM Warning : 
    From void Foam::motionSmootherAlgo::modifyMotionPoints(Foam::pointField&) const
    in file motionSmoother/motionSmootherAlgo.C at line 647
    2D mesh-motion probably not correct in parallel
 ...done
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 0
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0
Successfully moved mesh

Patch points smoothed in = 34.18 s



Morph iteration 0
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
    non-zone points : attract to nearest of all non-zone surfaces
    zone points     : attract to zone surface only

Wanted displacement : average:1.2399843e-10 min:1.6543612e-24 max:4.5097948e-10
Calculated surface displacement in = 0.05 s


Detecting near surfaces ...
Overriding nearest with intersection of close gaps at 40 out of 102490 points.
--> FOAM Warning : Displacement (7.6255749e-11 -1.0360545e-10 -2.0116474e-24) at mesh point 79 coord (4.9615e-07 2.6051667e-07 0) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Displacement smoothed in = 0.46 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Correcting 2-D mesh motion--> FOAM Warning : 
    From void Foam::motionSmootherAlgo::modifyMotionPoints(Foam::pointField&) const
    in file motionSmoother/motionSmootherAlgo.C at line 647
    2D mesh-motion probably not correct in parallel
 ...done
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 1502
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0

Iteration 1
Moving mesh using displacement scaling : min:0.75  max:1
Correcting 2-D mesh motion--> FOAM Warning : 
    From void Foam::motionSmootherAlgo::modifyMotionPoints(Foam::pointField&) const
    in file motionSmoother/motionSmootherAlgo.C at line 647
    2D mesh-motion probably not correct in parallel
 ...done
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 181
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0

Iteration 2
Moving mesh using displacement scaling : min:0.5625  max:1
Correcting 2-D mesh motion--> FOAM Warning : 
    From void Foam::motionSmootherAlgo::modifyMotionPoints(Foam::pointField&) const
    in file motionSmoother/motionSmootherAlgo.C at line 647
    2D mesh-motion probably not correct in parallel
 ...done
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 2
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0

Iteration 3
Moving mesh using displacement scaling : min:0.421875  max:1
Correcting 2-D mesh motion--> FOAM Warning : 
    From void Foam::motionSmootherAlgo::modifyMotionPoints(Foam::pointField&) const
    in file motionSmoother/motionSmootherAlgo.C at line 647
    2D mesh-motion probably not correct in parallel
 ...done
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 0
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0
Successfully moved mesh
Moved mesh in = 135.58 s


Repatching faces according to nearest surface ...
Repatched 0 faces in = 0.11 s


Edge intersection testing:
    Number of edges             : 1867444
    Number of edges to retest   : 1867444
    Number of intersected edges : 51088
Merging 14722 sets of faces.

Edge intersection testing:
    Number of edges             : 1852722
    Number of edges to retest   : 73606
    Number of intersected edges : 36366

Undo iteration 0
----------------
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 0
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0

Merging all points on surface that
- are used by only two boundary faces and
- make an angle with a cosine of more than 0.8660254.

Removing 29444 straight edge points ...

Edge intersection testing:
    Number of edges             : 1852722
    Number of edges to retest   : 73606
    Number of intersected edges : 36366

Undo iteration 0
----------------
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 0
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0
Snapped mesh : cells:460284  faces:1852722  points:943442  unbalance:0.0063352191
Cells per refinement level:
    0	460284
Writing mesh to time constant
Wrote mesh in = 0.18 s.
Mesh snapped in = 172.65 s.
Checking final mesh ...
Checking faces in error :
    non-orthogonality > 30  degrees                        : 0
    faces with face pyramid volume < -1                    : 0
    faces with face-decomposition tet quality < 0          : 0
    faces with concavity > 30  degrees                     : 0
    faces with skewness > 2   (internal) or 2   (boundary) : 0
    faces with interpolation weights (0..1)  < 0.1         : 0
    faces with volume ratio of neighbour cells < 0.1       : 0
    faces with face twist < 0.01                           : 0
    faces on cells with determinant < 0.01                 : 0
Finished meshing without any errors
Finished meshing in = 181.1 s.
End

Finalising parallel run
